(()=>{"use strict";var e={338:(e,o,n)=>{n.d(o,{h:()=>v,w:()=>U});var t=n(772),I=n(783),E=n(903),r=function(e,o,n,t){return new(n||(n=Promise))((function(I,E){function r(e){try{O(t.next(e))}catch(e){E(e)}}function i(e){try{O(t.throw(e))}catch(e){E(e)}}function O(e){var o;e.done?I(e.value):(o=e.value,o instanceof n?o:new n((function(e){e(o)}))).then(r,i)}O((t=t.apply(e,o||[])).next())}))};const i=new URLSearchParams(window.location.search),O=Number(i.get("venditoreID")),A=i.get("isbn");let c,s,l;const T=document.getElementById("aggiungiCopia");null==T||T.addEventListener("click",M);const N=document.getElementById("popupRegistraCopia"),a=document.getElementById("registraCopia");null==a||a.addEventListener("click",(function(){return r(this,void 0,void 0,(function*(){const e=yield function(){return r(this,void 0,void 0,(function*(){return new Promise(((e,o)=>{const n=c.transaction("Copie","readonly").objectStore("Copie").openCursor(null,"prev");n.onsuccess=()=>{const o=n.result;e(o?o.primaryKey:null)},n.onerror=()=>{o(n.error)}}))}))}();let o;if(o=null!==e?e+1:1,""!==d.value)if(null!=l){const e=new t.N(l,o,parseFloat(d.value),s,"D");l=null,yield function(e){return r(this,void 0,void 0,(function*(){const o=c.transaction("Copie","readwrite").objectStore("Copie").add(e);o.onsuccess=()=>{d.value="",C.value="",i.delete("isbn"),i.delete("prezzoCopertina"),I.D.postMessage({store:"Copie"}),D(e);const o=`${window.location.pathname}?${i.toString()}`;window.history.replaceState({},"",o),m(),p()},o.onerror=()=>{console.error("Copia già presente")}}))}(e)}else window.alert("Scegliere un libro dalla libreria da associarte alla copia che si vuole registrare");else window.alert("Inserire il prezzo di copertina per procedere con la registrazione")}))}));const L=document.getElementById("chiudiPopup");null==L||L.addEventListener("click",p);const R=document.getElementById("scegliLibro");null==R||R.addEventListener("click",(function(){const e=new URLSearchParams;e.set("venditoreID",String(s.id));const o=d.value;e.set("prezzoCopertina",o),window.location.href=`selezionaLibro.html?${e.toString()}`}));const d=document.getElementById("prezzoCopertina"),C=document.getElementById("titoloLibro"),u=document.getElementById("eliminaCopie");null==u||u.addEventListener("click",(function(){return r(this,void 0,void 0,(function*(){const e=document.querySelectorAll('input[type="checkbox"].caselleSelezione:checked');if(0!==e.length){if(window.confirm("Sei sicuro di voler eliminare le copie selezionate?"))try{const o=c.transaction("Copie","readwrite").objectStore("Copie"),n=Array.from(e).map((e=>r(this,void 0,void 0,(function*(){var n,t;const E=e.closest("tr");if(E){const e=null===(t=null===(n=E.cells[1])||void 0===n?void 0:n.textContent)||void 0===t?void 0:t.trim();if(e)return new Promise(((n,t)=>{const E=o.get(Number(e));E.onsuccess=()=>{const r=E.result;if(r){console.log("RIsultato prova eliminazione:"+r),r.stato="E";const E=o.put(r);E.onsuccess=()=>{I.D.postMessage({store:"Copie"}),D(r),n()},E.onerror=()=>{t(new Error(`Errore nell'aggiornamento della copia ${e}.`))}}else t(new Error(`Copia con ID ${e} non trovata.`))},E.onerror=()=>{t(new Error(`Errore nel recupero della copia ${e}.`))}}));Promise.resolve()}else Promise.resolve()}))));yield Promise.all(n),window.alert("Copia/e eliminate."),yield m()}catch(e){e instanceof Error&&console.error(e.message)}}else window.alert("Seleziona almeno una copia da eliminare.")}))}));const S=document.getElementById("vendiCopie");function D(e){return r(this,void 0,void 0,(function*(){let o;if(e instanceof t.N)o=e;else{const n=e,I=yield U(Number(n.libroDellaCopiaISBN)),E=yield v(Number(n.venditoreID));o=new t.N(I,Number(n.codiceUnivoco),Number(n.prezzoCopertina),E,n.stato)}E.ws.send("C,"+String(null==o?void 0:o.toString()))}))}function M(){null!=N&&(N.style.display="flex")}function p(){null!=N&&(N.style.display="none")}function m(){return r(this,void 0,void 0,(function*(){try{const e=yield function(){return r(this,void 0,void 0,(function*(){return new Promise(((e,o)=>{const n=c.transaction("Copie","readonly").objectStore("Copie").index("venditoreID").getAll(O);n.onsuccess=()=>{e(n.result)},n.onerror=()=>{o(n.error)}}))}))}();if(!O)throw new Error("ID venditore non valido");const o=c.transaction("Venditori","readonly").objectStore("Venditori");s=yield new Promise(((e,n)=>{const t=o.get(O);t.onsuccess=()=>{t.result?e(t.result):n(new Error("Venditore non trovato con ID: "+O))},t.onerror=e=>{console.error("Errore nella richiesta:",e),n(t.error)}}));const n=document.getElementById("corpoInfoVenditore");n.innerHTML="";const t=function(e){let o=0;for(let n=0;n<e.length;n++)"V"==e[n].stato&&(o+=e[n].prezzoScontato);return Number(o.toFixed(2))}(e),I=document.createElement("tr");I.innerHTML=`<td>${s.id}</td><td>${s.nome}</td><td>${s.cognome}</td><td>${s.email}</td><td>${s.nTelefono}</td><td>${s.classe}</td><td>${t}</td>`,n.appendChild(I);const E=document.getElementById("corpoTabellaCopie");E.innerHTML="";for(let o=0;o<e.length;o++){const n=e[o];if("E"!==n.stato){const e=yield new Promise(((e,o)=>{const t=c.transaction("Libri","readonly").objectStore("Libri").get(n.libroDellaCopiaISBN);t.onsuccess=()=>{t.result?e(t.result):o(new Error("Libro con ISBN non trovato"))},t.onerror=()=>{o(new Error("Database dei libri non reperibile"))}})),o=document.createElement("tr"),t=document.createElement("td"),I=document.createElement("input");I.setAttribute("type","checkbox"),I.setAttribute("class","caselleSelezione"),"V"===n.stato&&(I.disabled=!0,o.classList.add("venduta")),t.appendChild(I),o.appendChild(t);const r=document.createElement("td");r.textContent=String(n.codiceUnivoco),o.appendChild(r);const i=document.createElement("td");i.textContent=String(e.isbn),o.appendChild(i);const O=document.createElement("td");O.textContent=e.titolo,o.appendChild(O);const A=document.createElement("td");A.textContent=String(n.prezzoCopertina),o.appendChild(A);const s=document.createElement("td");s.textContent=String(n.prezzoScontato),o.appendChild(s),E.appendChild(o)}}}catch(e){e instanceof Error&&console.error(e.message)}}))}function U(e){return r(this,void 0,void 0,(function*(){const o=c.transaction("Libri","readonly").objectStore("Libri");return yield new Promise(((n,t)=>{const I=o.get(e);I.onsuccess=()=>{I.result?n(I.result):t(new Error("Libro non trovato con ISBN"+e))},I.onerror=e=>{console.error("Errore nella richiesta:",e),t(I.error)}}))}))}function v(e){return r(this,void 0,void 0,(function*(){const o=c.transaction("Venditori","readonly").objectStore("Venditori");return yield new Promise(((n,t)=>{const I=o.get(e);I.onsuccess=()=>{I.result?n(I.result):t(new Error("Venditore non trovato con codice fiscale: "+e))},I.onerror=e=>{console.error("Errore nella richiesta:",e),t(I.error)}}))}))}null==S||S.addEventListener("click",(function(){return r(this,void 0,void 0,(function*(){const e=document.querySelectorAll('input[type="checkbox"].caselleSelezione:checked');if(0!==e.length){if(window.confirm("Sei sicuro di voler vendere le copie selezionate?"))try{const o=c.transaction("Copie","readwrite").objectStore("Copie"),n=Array.from(e).map((e=>r(this,void 0,void 0,(function*(){var n,t;const E=e.closest("tr");if(E){const e=null===(t=null===(n=E.cells[1])||void 0===n?void 0:n.textContent)||void 0===t?void 0:t.trim();if(e)return new Promise(((n,t)=>{const E=o.get(Number(e));E.onsuccess=()=>{const r=E.result;if(r){r.stato="V";const E=o.put(r);E.onsuccess=()=>{I.D.postMessage({store:"Copie"}),I.D.postMessage({store:"Venditori"}),D(r),n()},E.onerror=()=>{t(new Error(`Errore nell'aggiornamento della copia ${e}.`))}}else t(new Error(`Copia con ID ${e} non trovata.`))},E.onerror=()=>{t(new Error(`Errore nel recupero della copia ${e}.`))}}));Promise.resolve()}else Promise.resolve()}))));yield Promise.all(n),window.alert("Copia/e vendute con successo."),yield m()}catch(e){e instanceof Error&&console.error(e.message)}}else window.alert("Seleziona almeno una copia da vendere.")}))})),E.ws.onopen=function(){console.log("aperto il server")},E.ws.onclose=function(){console.log("connessione server chiusa")},E.ws.onerror=function(e){console.log("errore nel webSocket",e)},I.D.onmessage=e=>r(void 0,void 0,void 0,(function*(){"Copie"===e.data.store&&(console.log("Aggiornamento ricevuto: ricarico copie..."),location.reload())})),document.addEventListener("DOMContentLoaded",(()=>r(void 0,void 0,void 0,(function*(){try{c=yield function(){let e=new Promise(((e,o)=>{const n=indexedDB.open("Database",1);n.onerror=()=>{o(n.onerror)},n.onsuccess=()=>{const o=n.result;e(o)}}));return e}(),console.log("Database aperto:",c.name),yield m(),null!=A&&function(){r(this,void 0,void 0,(function*(){try{null!=A&&(l=yield U(Number(A)),d.value=i.get("prezzoCopertina"),C.value=l.titolo,M())}catch(e){console.error("Venditore NON reperibile",e)}}))}()}catch(e){console.error(e)}}))))},772:(e,o,n)=>{n.d(o,{N:()=>t});class t{constructor(e,o,n,t,I){this.libroDellaCopiaISBN=e.isbn,this.codiceUnivoco=o,this.prezzoCopertina=n,this.prezzoScontato=parseFloat((.5*n).toFixed(2)),this.venditoreID=t.id,this.stato=I}toString(){return`${this.libroDellaCopiaISBN};${this.codiceUnivoco};${this.prezzoCopertina};${this.prezzoScontato};${this.venditoreID};${this.stato}`}}},783:(e,o,n)=>{n.d(o,{D:()=>t});const t=new BroadcastChannel("aggiornamentoDatabase")},903:(e,o,n)=>{n.d(o,{ws:()=>t});const t=new WebSocket("ws://192.168.1.100:8082");t.onopen=function(){console.log("aperto il server")},t.onclose=function(){console.log("connessione server chiusa")},t.onerror=function(e){console.log("errore nel webSocket",e)}}},o={};function n(t){var I=o[t];if(void 0!==I)return I.exports;var E=o[t]={exports:{}};return e[t](E,E.exports,n),E.exports}n.d=(e,o)=>{for(var t in o)n.o(o,t)&&!n.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:o[t]})},n.o=(e,o)=>Object.prototype.hasOwnProperty.call(e,o);var t=n(772);class I{constructor(e,o,n,t,I,E){let r=Number(I);this.id=e>=0?e:0,this.nome=null!=o?o:"-",this.cognome=null!=n?n:"-",this.email=null!=t?t:"-",this.nTelefono=r>0?r:0,this.classe=null!=E?E:"-"}toString(){return[this.id,this.nome,this.cognome,this.email,this.nTelefono,this.classe].join(" ")}}var E=n(783);class r{constructor(e,o,n,t,I,E,r){this.materia=null!=e?e:"-",Number(o)>0?this.isbn=Number(o):this.isbn=0,this.autore=null!=n?n:"-",this.titolo=null!=t?t:"-",null!=I&&1==I.length?this.volume=I:this.volume="-",this.editore=null!=E?E:"-",this.classe=null!=r?r:"-"}toString(){return[this.materia,this.isbn,this.autore,this.titolo,this.volume,this.editore,this.classe].join(" ")}}const i=[new r("DIRITTO ED ECONOMIA","9788823367739","D'AMELIO MARIA GIOVANNA","FUTURO IN TASCA (IL) - LIBRO MISTO CON LIBRO DIGITALE  CORSO DI DIRITTO ED ECONOMIA PER IL PRIMO BIENNIO - VOLUME UNICO","U","TRAMONTANA","1 - 2"),new r("DIRITTO ED ECONOMIA","9788861603820","MARIA RITA CATTANI","NUOVO SISTEMA DIRITTO APP - DIRITTO COMMERCIALE (IL)","2","PARAMOND","4"),new r("DIRITTO ED ECONOMIA","9788861604711","CATTANI MARIA RITA, GUZZI CLAUDIO","SISTEMA DIRITTO SECONDA EDIZIONE - SECONDO BIENNIO  CORSO DI DIRITTO","U","PARAMOND","3"),new r("DIRITTO ED ECONOMIA","9788891420091","AVOLIO ALESSANDRA","TRASPORTI LOGISTICA LEGGI E MERCATI DIRITTO ED ECONOMIA PER SECONDO BIENNIO E QUINTO ANNO ARTICOL LOGISTICA","U","SIMONE PER LA SCUOLA","5"),new r("ELETTROTECNICA ED ELETTRONICA","9788823373266","AMBROSINI ENRICO, SPADARI FILIPPO","ELETTROTECNICA ED ELETTRONICA VOLUME 1","1","TRAMONTANA","3"),new r("ELETTROTECNICA ED ELETTRONICA","9788820378493","CONTE GAETANO, IMPALLOMENI EMANUELE","ELETTROTECNICA, ELETTRONICA E AUTOMAZIONE NUOVA EDIZIONE OPENSCHOOL PER IL SECONDO BIENNIO DELL'INDIRIZZO TRASPORTI E LOGISTICA","U","HOEPLI","3 - 4 - 5"),new r("ELETTROTECNICA ED ELETTRONICA","9788823342002","AMBROSINI, SPADARI","ELETTROTECNICA ED ELETTRONICA 2 CON OPENBOOK VOLUME 2 + OPENBOOK","2","TRAMONTANA","4"),new r("ELETTROTECNICA ED ELETTRONICA","9788823346000","AMBROSINI, SPADARI","ELETTROTECNICA ED ELETTRONICA 3 CON OPENBOOK VOLUME 3 + OPENBOOK","3","TRAMONTANA","5"),new r("GEOGRAFIA","9788851187477","BIANCHI S KOEHLER R","GEOBASE-CORSO DI GEOGRAFIA GENERALE ED ECONOMICA PER IST.TECNICI PROFESS. VOLUME BASE+ EBOOK","U","DE AGOSTINI","2"),new r("GESTIONE PROGETTO E ORGANIZZAZIONE D'IMPRESA","9788874858323","IACOBELLI CESARE, COTTONE MARIO, GAIDO ELENA","DALL'IDEA ALLA STARTUP VOLUME UNICO","U","JUVENILIA","5"),new r("INFORMATICA","9788826821887","LORENZI AGOSTINO, RIZZI ANDREA","PRO.TECH B","2","ATLAS","4"),new r("INFORMATICA","9788836007745","CAMAGNI PAOLO, NIKOLASSY RICCARDO","CORSO DI INFORMATICA SQL & PHP  PERCORSI MODULARI PER LINGUAGGI DI PROGRAMMAZIONE","U","HOEPLI","5"),new r("INGLESE","9788844119836","ROBBA MARGHERITA, FAGGIANI MARIA LETIZIA","NEW MECHWAYS - ENGLISH FOR MECHANICS, MECHATRONICS AND ENERGY","U","EDISCO","3 - 4 - 5"),new r("INGLESE","9788861618176","SBOLOGNINI, B C BARBER, KO'MALLEY","CAREER PATHS IN TECHNOLOGY ELECTRICITY AND ELECTRONICSÂ INFORMATION TECHNOLOGY AND TELECOMMUNICATIONS","U","LANG EDIZIONI","3 - 4 - 5"),new r("INGLESE","9788883394485","AA VV","MY VOICE A2/B1","U","PEARSON LONGMAN","1 - 2"),new r("INGLESE","9788883394492","AA VV","MY VOICE B1/B1+","U","PEARSON LONGMAN","2"),new r("INGLESE","9788883395994","AA VV","MY VOICE B2","U","PEARSON LONGMAN","3 - 4 - 5"),new r("INGLESE","9788899673154","GUALANDRI, CANELLINI","ALL ABOUT LOGISTICS PLUS + CD AUDIO 50241  STORAGE & DELIVERY","U","TRINITY WHITEBRIDGE","3 - 4 - 5"),new r("ITALIANO ANTOLOGIE E STORIA LETTERATURA","9788830206779","SAMBUGAR MARTA, SALA' GABRIELLA","CODICE LETTERARIO 2020 - LIBRO MISTO CON LIBRO DIGITALE  VOLUME 3A + VOLUME 3B + FASCICOLO 5° ANNO","3","LA NUOVA ITALIA EDITRICE","5"),new r("ITALIANO ANTOLOGIE E STORIA LETTERATURA","9788830206793","SAMBUGAR MARTA, SALA' GABRIELLA","CODICE LETTERARIO 2020 - LIBRO MISTO CON LIBRO DIGITALE  VOL 1+LABORATORIO 3° 4° ANNO+DIVINA COMMEDIA+INVALSI","1","LA NUOVA ITALIA EDITRICE","3"),new r("ITALIANO ANTOLOGIE E STORIA LETTERATURA","9788830212428","SAMBUGAR MARTA, SALA' GABRIELLA","CODICE LETTERARIO 2020 - LIBRO MISTO CON LIBRO DIGITALE  VOL 2 CON LEOPARDI+LABORATORIO 3° 4° ANNO","2","LA NUOVA ITALIA EDITRICE","4"),new r("ITALIANO ANTOLOGIE","9788869109225","SIMONA BRENNA, DANIELE DACCO","STORIE IN TASCA - NARRATIVA CON VEDERE LE STORIE","U","B.MONDADORI","1"),new r("ITALIANO ANTOLOGIE","9788869109263","SIMONA BRENNA, DANIELE DACCO","STORIE IN TASCA - POESIA E TEATRO CON ANTOLOGIA DEI PROMESSI SPOSI","U","B.MONDADORI","2"),new r("ITALIANO EPICA","9788869109348","SIMONA BRENNA, DANIELE DACCO","STORIE IN TASCA - MITO ED EPICA","U","B.MONDADORI","1"),new r("ITALIANO GRAMMATICA","9791254550106","SAVIGLIANO C","GRAMMATUTOR - PER PARLARE E SCRIVERE BENE  VOLUME BASE + LABORATORIO DELLE COMPETENZE + EBOOK","U","GARZANTI SCUOLA","1 - 2"),new r("LOGISTICA","9788836007943","DALLARI FABRIZIO","CORSO DI LOGISTICA E TRASPORTI  ELEMENTI DI BASE, SOLUZIONI TECNICHE E MODELLI OPERATIVI","1","HOEPLI","3"),new r("LOGISTICA","9788836012275","DALLARI FABRIZIO, COSSU ELENA","CORSO DI LOGISTICA E TRASPORTI  ORGANIZZAZIONE E GESTIONE DELLA SUPPLY CHAIN E DELLA SICUREZZA","2","HOEPLI","4 - 5"),new r("MATEMATICA","9788849422979","SASSO LEONARDO, ZOLI ENRICO","COLORI DELLA MATEMATICA - EDIZIONE VERDE VOL. 3 + EBOOK +  STATISTICA E CALCOLO DELLE PROBABILITÀ","1","PETRINI","3"),new r("MATEMATICA","9788849422986","SASSO LEONARDO, ZOLI ENRICO","COLORI DELLA MATEMATICA - EDIZIONE VERDE VOL. 4 + EBOOK +","2","PETRINI","4"),new r("MATEMATICA","9788849422993","SASSO LEONARDO, ZOLI ENRICO","COLORI DELLA MATEMATICA - EDIZIONE VERDE VOL. 5 + EBOOK +","3","PETRINI","5"),new r("MATEMATICA","9788849425215","SASSO L ZOLI E","TUTTI I COLORI DELLA MATEMATICA - EDIZIONE VERDE - PRIMO BIENNIO  VOLUME 1 + QUADERNO DI INCLUSIONE E RECUPERO 1 + EBOOK","1","PETRINI","1"),new r("MATEMATICA","9788849425222","SASSO L ZOLI E","TUTTI I COLORI DELLA MATEMATICA - EDIZIONE VERDE - PRIMO BIENNIO  VOLUME 2 + QUADERNO DI INCLUSIONE E RECUPERO 2 + EBOOK","2","PETRINI","2"),new r("MECCANICA","9788820383329","AA VV","MANUALE DEL MANUTENTORE","U","HOEPLI","3 - 4 - 5"),new r("RELIGIONE","9788839303394","CERA T, FAMA' A","STRADA CON L'ALTRO (LA) - VOLUME UNICO LEZIONI E PERCORSI + EBOOK","U","MARIETTI SCUOLA","3 - 4 - 5"),new r("RELIGIONE","9788839303943","CERA T, FAMA A, SORICE O","STRADA CON L'ALTRO - EDIZIONE VERDE (LA)  VOLUME UNICO + UDA MULTIDISCIPLINARI DI EDUCAZIONE CIVICA E IRC + EBOOK","U","MARIETTI SCUOLA","1 - 2"),new r("SCIENZE DELLA NAVIGAZIONE","9788836015221","DALLARI FABRIZIO, COSSU ELENA","CORSO DI LOGISTICA E TRASPORTI  SPEDIZIONI, NORMATIVA E COMMERCIO INTERNAZIONALE","3","HOEPLI","3"),new r("SCIENZE DELLA TERRA","9788808690913","LUPIA PALMIERI ELVIDIO, PAROTTO MAURIZIO","SCIENZE DELLA TERRA 4ED. - VOL. U (LDM)","U","ZANICHELLI EDITORE","1"),new r("SCIENZE INTEGRATE (CHIMICA)","9788823365957","CORDIOLI DORIANO","CHIMICA PRATICA - LIBRO MISTO CON LIBRO DIGITALE  VOLUME UNICO PER IL BIENNIO","U","TRAMONTANA","1 - 2"),new r("SCIENZE INTEGRATE (FISICA)","9788863648850","WALKER","FISICA DI WALKER (LA) - VOLUME UNICO","U","LINX","1 - 2"),new r("SCIENZE INTEGRATE (SCIENZE DELLA TERRA E BIOLOGIA)","9788808554055","LUPIA PALMIERI ELVIDIO, PAROTTO MAURIZIO, SARACENI S, STRUMIA G","SCIENZE NATURALI 3ED. - BIOLOGIA (LDM) DI SILVIA SARACENI E GIORGIO STRUMIA","U","ZANICHELLI EDITORE","2"),new r("SISTEMI AUTOMATICI","9788820394844","CERRI FABRIZIO, ORTOLANI GIULIANO, VENTURI EZIO","NUOVO CORSO DI SISTEMI AUTOMATICI  PER LE ARTICOLAZIONI ELETTROTECNICA, ELETTRONICA E AUTOMAZIONE DEGLI ISTITUT","1","HOEPLI","3"),new r("SISTEMI AUTOMATICI","9788820394851","CERRI FABRIZIO, ORTOLANI GIULIANO, VENTURI EZIO","NUOVO CORSO DI SISTEMI AUTOMATICI  PER LE ARTICOLAZIONI ELETTROTECNICA, ELETTRONICA E AUTOMAZIONE DEGLI ISTITUT","2","HOEPLI","4"),new r("SISTEMI AUTOMATICI","9788836003785","CERRI FABRIZIO, ORTOLANI GIULIANO, VENTURI EZIO","NUOVO CORSO DI SISTEMI AUTOMATICI  PER L'ARTICOLAZIONE ELETTRONICA DEGLI ISTITUTI TECNICI SETTORE TECNOLOGICO","3","HOEPLI","5"),new r("SISTEMI E RETI","9788849423266","ANELLI S, MACCHI P, ANGIANI G, ZICCHIERI G","GATEWAY - SISTEMI E RETI SECONDA EDIZIONE - VOLUME 2 + EBOOK","2","PETRINI","4"),new r("SISTEMI E RETI","9788849423273","ANELLI S, MACCHI P, ANGIANI G, ZICCHIERI G","GATEWAY - SISTEMI E RETI SECONDA EDIZIONE - VOLUME 3 + EBOOK- IN PREPARAZIONE","3","PETRINI","5"),new r("SISTEMI E RETI","9788849426403","ANELLI S, MACCHI P","GATEWAY TERZA EDIZIONE + EBOOK VOLUME 1 PER IL III ANNO + EBOOK","1","PETRINI","3"),new r("STORIA","9788805076659","FELTRI FRANCESCO MARIA, BERTAZZONI MARIA MANUELA, NERI FRANCA","SCENARI 3 NOVECENTO E XXI SECOLO","3","SEI","5"),new r("STORIA","9788822197320","BRANCATI ANTONIO, PAGLIARANI TREBI","STORIA IN MOVIMENTO LIBRO MISTO CON LIBRO DIGITALE  VOLUME 3, LAVORARE CON LA STORIA 3","3","LA NUOVA ITALIA EDITRICE","5"),new r("STORIA","9788835055204","GENTILE, RONGA, ROSSI","FUCINA DI VULCANO - VOLUME 1 (LA)  CORSO DI STORIA ED EDUCAZ.CIVICA","1","LA SCUOLA EDITRICE","1 - 2"),new r("STORIA","9788835055211","GENTILE, RONGA, ROSSI","FUCINA DI VULCANO - VOLUME 2 (LA)  CORSO DI STORIA ED EDUCAZ.CIVICA","2","LA SCUOLA EDITRICE","2"),new r("STORIA","9788839538864","GIOVANNI DE LUNA, MARCO MERIGGI","VALORE STORIA 1 DALL'ANNO MILLE ALLA METÀ DEL SEICENTO","1","PARAVIA","3"),new r("STORIA","9788839538871","GIOVANNI DE LUNA, MARCO MERIGGI","VALORE STORIA 2 DALLA METÀ DEL SEICENTO ALLA FINE DELL'OTTOCENTO","2","PARAVIA","4"),new r("STRUTTURA, COSTRUZIONE, SISTEMI E IMPIANTI","9788884883148","AA VV","TECNICA DELL'AUTOMOBILE MANUALE DI TECNOLOGIA DEI VEICOLI A MOTORE","U","SAN MARCO","3 - 4 - 5"),new r("TECNOLOGIE E PROGETTAZIONE DI SISTEMI INFO","9788836011728","CAMAGNI PAOLO, NIKOLASSY RICCARDO","TECNOLOGIE E PROGETTAZIONE DI SISTEMI INFORMATICI E DI TELECOMUNICAZION  PER L'ARTICOLAZIONE INFORMATICA DEGLI ISTITUTI TECNICI SETTORE TECNOLOGICO","1","HOEPLI","3"),new r("TECNOLOGIE E PROGETTAZIONE","9788823357150","BOVE ENEA, PORTALURI GIORGIO","TECNOLOGIE E PROGETTAZIONE DI SISTEMI ELETTRICI ED ELETTRONICI - LIBRO MISTO  ART. ELETTRONICA - VOL. 1 + HUB YOUNG + HUB KIT","1","TRAMONTANA","3"),new r("TECNOLOGIE E PROGETTAZIONE","9788823357983","BOVE ENEA, PORTALURI GIORGIO","TECNOLOGIE E PROGETTAZIONE DI SISTEMI ELETTRICI ED ELETTRONICI  ART. ELETTRONICA - VOL. 2 + HUB YOUNG + HUB KIT","2","TRAMONTANA","4"),new r("TECNOLOGIE E PROGETTAZIONE","9788823357990","BOVE ENEA, PORTALURI GIORGIO","TECNOLOGIE E PROGETTAZIONE DI SISTEMI ELETTRICI ED ELETTRONICI  ART. ELETTRONICA - VOL. 3 + HUB YOUNG + HUB KIT","3","TRAMONTANA","5"),new r("TECNOLOGIE E TECNICHE DI RAPPRESENT.GRAFICA","9788841651780","ZANIN ALBINO, BALDISSERI GIORGIO","TECNOGRAFICA + DISEGNO + TECNOLOGIA","U","PRINCIPATO","1 - 2"),new r("TECNOLOGIE INFORMATICHE","9788820372279","BOSCAINI MAURIZIO, LUGHEZZANI FLAVIA, PRINCIVALLE DANIELA","MASTERMIND PENSARE - PROGRAMMARE - CONDIVIDERE. INFORMATICA PER IL PRIMO BIENNIO","U","HOEPLI","1"),new r("TELECOMUNICAZIONI","9788808159304","BERTAZIOLI ONELIO","CORSO DI TELECOMUNICAZIONI 1 (LMS LIBRO MISTO SCARICABILE)  RETI ELETTRICHE. FOND. ELETTRONICA DIGITALE. NOZIONI SIST. TELECOMUNICAZIONI","1","ZANICHELLI EDITORE","3"),new r("TELECOMUNICAZIONI","9788808228628","BERTAZIOLI ONELIO","CORSO DI TELECOMUNICAZIONI 2 (LIBRO MISTO SCARICABILE) MEZZI TRASMISSIVI. ELETTRONICA PER TELECOMUNICAZIONI. RETE TELEFONICA","2","ZANICHELLI EDITORE","4"),new r("TELECOMUNICAZIONI","9788808834997","BERTAZIOLI ONELIO","CORSO DI TELECOMUNICAZIONI - VOL 3 + RISORSE SCUOLABOOK PER TELECOM. RETI, SIST. E APP. TELECOMUNICAZIONI DIGITALI DI N. GENERAZIONE","3","ZANICHELLI EDITORE","5"),new r("TELECOMUNICAZIONI","9788823357037","AMBROSINI ENRICO, PERLASCA IPPOLITO, MAINI PIERPAOLO","TELECOMUNICAZIONI - LIBRO MISTO CON HUB LIBRO YOUNG  VOL. + HUB YOUNG + HUB KIT","U","TRAMONTANA","4")];var O=n(338),A=n(903),c=function(e,o,n,t){return new(n||(n=Promise))((function(I,E){function r(e){try{O(t.next(e))}catch(e){E(e)}}function i(e){try{O(t.throw(e))}catch(e){E(e)}}function O(e){var o;e.done?I(e.value):(o=e.value,o instanceof n?o:new n((function(e){e(o)}))).then(r,i)}O((t=t.apply(e,o||[])).next())}))};let s,l;const T=document.getElementById("aggiungiVenditore");null==T||T.addEventListener("click",(function(){null!=N&&(N.style.display="flex")}));const N=document.getElementById("popupNuovoVenditore"),a=document.getElementById("registraVenditore");null==a||a.addEventListener("click",(function(){return c(this,void 0,void 0,(function*(){let e=new Array(5);for(let o=0;o<R.length;o++)e[o]=R[o].value;const o=yield function(){return c(this,void 0,void 0,(function*(){return new Promise(((e,o)=>{const n=s.transaction("Venditori","readonly").objectStore("Venditori").openCursor(null,"prev");n.onsuccess=()=>{const o=n.result;e(o?o.primaryKey:null)},n.onerror=()=>{o(n.error)}}))}))}();let n;n=null!==o?o+1:1;const t=new I(n,e[0],e[1],e[2],Number(e[3]),e[4]),r=s.transaction("Venditori","readwrite").objectStore("Venditori").add(t);r.onsuccess=()=>c(this,void 0,void 0,(function*(){for(let e=0;e<R.length;e++)R[e].value="";E.D.postMessage({store:"Venditori"}),function(e){A.ws.send("V,"+String(e.toString()))}(t),S(yield u()),C()})),r.onerror=()=>{console.log("Venditore già presente")}}))}));const L=document.getElementById("chiudiPopup");null==L||L.addEventListener("click",C);const R=document.querySelectorAll(".testoInputPopup"),d=document.getElementById("casellaRicerca");function C(){null!=N&&(N.style.display="none")}function u(){return c(this,void 0,void 0,(function*(){let e;try{const o=s.transaction("Venditori","readonly").objectStore("Venditori");return e=(yield new Promise(((e,n)=>{const t=o.getAll();t.onsuccess=()=>e(t.result),t.onerror=()=>n(t.error)}))).map((e=>new I(e.id,e.nome,e.cognome,e.email,e.nTelefono,e.classe))),e}catch(e){return window.alert("Errore durante il caricamento dei venditori:"+e),null}}))}function S(e){return c(this,void 0,void 0,(function*(){const o=document.getElementById("corpoTabellaVenditori");if(o.innerHTML="",null!=e){const n=yield function(){return c(this,void 0,void 0,(function*(){let e=new Array;const o=yield new Promise(((e,o)=>{const n=s.transaction("Venditori","readonly").objectStore("Venditori").getAll();n.onsuccess=()=>e(n.result),n.onerror=()=>o(n.error)}));for(const n of o){const o=(yield new Promise(((e,o)=>{const t=s.transaction("Copie","readonly").objectStore("Copie").index("venditoreID").getAll(n.id);t.onsuccess=()=>{const o=t.result.filter((e=>"V"===e.stato));e(o)},t.onerror=()=>o(t.error)}))).reduce(((e,o)=>e+o.prezzoScontato),0);e.push(Number(o.toFixed(2)))}return e}))}();for(let t=0;t<e.length;t++){const I=document.createElement("tr"),E=document.createElement("td");E.textContent=String(e[t].id),I.appendChild(E);const r=document.createElement("td");r.textContent=e[t].nome,I.appendChild(r);const i=document.createElement("td");i.textContent=e[t].cognome,I.appendChild(i);const O=document.createElement("td");O.textContent=e[t].email,I.appendChild(O);const A=document.createElement("td");A.textContent=String(e[t].nTelefono),I.appendChild(A);const c=document.createElement("td");c.textContent=e[t].classe,I.appendChild(c);const s=document.createElement("td");s.textContent=String(n[t]),I.appendChild(s);const l=document.createElement("td"),T=document.createElement("button");T.textContent="Visualizza copie consegnate",T.addEventListener("click",(()=>D(e[t].id))),l.appendChild(T),I.appendChild(l),o.appendChild(I)}}else console.log("Nessun venditore da mostrare")}))}function D(e){const o=screen.height,n=screen.width;window.open(`html/gestoreCopieVenditore.html?venditoreID=${e}`,"_blank",`menubar=no", height=${o}, width=${n}, top=0, left=0`)}null==d||d.addEventListener("input",(function(){return c(this,void 0,void 0,(function*(){if(null!=l){let e,o=[];if(d&&""!==d.value.trim()){e=d.value.toLowerCase();for(let n=0;n<l.length;n++)l[n].toString().toLowerCase().includes(e)&&o.push(l[n]);yield S(o)}else yield S(l)}}))})),A.ws.onmessage=function(e){console.log(e.data);let o=e.data.split(",");"V"===o[0]?function(e){c(this,void 0,void 0,(function*(){try{const o=e.split(" ");console.log(o);const n=new I(Number(o[0]),o[1],o[2],o[3],Number(o[4]),o[5]);yield function(e){return c(this,void 0,void 0,(function*(){const o=e,n=s.transaction("Venditori","readwrite").objectStore("Venditori").add(o);n.onsuccess=()=>c(this,void 0,void 0,(function*(){for(let e=0;e<R.length;e++)R[e].value="";E.D.postMessage({store:"Venditori"}),S(yield u()),C()})),n.onerror=()=>{console.log("Venditore già presente")}}))}(n)}catch(e){console.error("Errore nel salvataggio del venditore mediante CF trasmesso da socket")}}))}(o[1]):"C"===o[0]&&function(e){c(this,void 0,void 0,(function*(){try{const o=e.split(";");console.log(o);const n=yield(0,O.w)(Number(o[0])),I=yield(0,O.h)(Number(o[4])),r=new t.N(n,Number(o[1]),Number(o[2]),I,o[5]);console.log(r),yield function(e){return c(this,void 0,void 0,(function*(){const o=s.transaction("Copie","readwrite").objectStore("Copie").put(e);o.onsuccess=()=>{E.D.postMessage({store:"Copie"})},o.onerror=()=>{console.log("Copia già presente")}}))}(r)}catch(e){console.error("Errore nel recupero del libro mediante ISBN o del venditore mediante CF trasmesso da socket")}}))}(o[1])},E.D.onmessage=e=>c(void 0,void 0,void 0,(function*(){"Venditori"===e.data.store&&(console.log("Aggiornamento ricevuto: ricarico venditori..."),location.reload())})),document.addEventListener("DOMContentLoaded",(()=>c(void 0,void 0,void 0,(function*(){try{s=yield function(){let e=new Promise(((e,o)=>{const n=indexedDB.open("Database",1);n.onerror=()=>{o(n.onerror)},n.onsuccess=()=>{const o=n.result;e(o)},n.onupgradeneeded=()=>{const e=n.result;if(!e.objectStoreNames.contains("Libri")){const o=e.createObjectStore("Libri",{keyPath:"isbn"});o.createIndex("materia","materia",{unique:!1}),o.createIndex("autore","autore",{unique:!1}),o.createIndex("titolo","titolo",{unique:!1}),o.createIndex("volume","volume",{unique:!1}),o.createIndex("editore","editore",{unique:!1}),o.createIndex("prezzoListino","prezzoListino",{unique:!1}),o.createIndex("classe","classe",{unique:!1})}if(!e.objectStoreNames.contains("Copie")){const o=e.createObjectStore("Copie",{keyPath:"codiceUnivoco"});o.createIndex("libroDellaCopiaISBN","libroDellaCopiaISBN",{unique:!1}),o.createIndex("prezzoScontato","prezzoScontato",{unique:!1}),o.createIndex("venditoreID","venditoreID",{unique:!1}),o.createIndex("stato","stato",{unique:!1})}if(!e.objectStoreNames.contains("Venditori")){const o=e.createObjectStore("Venditori",{keyPath:"id"});o.createIndex("nome","nome",{unique:!1}),o.createIndex("cognome","cognome",{unique:!1}),o.createIndex("email","email",{unique:!1}),o.createIndex("nTelefono","nTelefono",{unique:!0}),o.createIndex("classe","classe",{unique:!1})}}}));return e}(),console.log("Database aperto:",s.name),yield function(){return c(this,void 0,void 0,(function*(){try{const e=s.transaction("Libri","readonly").objectStore("Libri").count();e.onsuccess=()=>{0===e.result?function(){const e=s.transaction("Libri","readwrite"),o=e.objectStore("Libri");for(let e=0;e<i.length;e++)o.add(i[e]);e.oncomplete=()=>{console.log("Libri caricati con successo.")},e.onerror=()=>{console.error("Errore durante il caricamento dei libri statici.")}}():console.log("Libri già presenti nel database")},e.onerror=()=>{console.error("Errore nel conteggio dei libri.")}}catch(e){console.error("Errore durante l'accesso al DB:",e)}}))}(),l=yield u(),yield S(l)}catch(e){console.error("Errore apertura DB:",e)}}))))})();