(()=>{"use strict";const e=new URLSearchParams(window.location.search).get("id");let t,o=[],n=0;function r(e){return new Promise(((o,n)=>{const r=t.transaction("Libri","readonly").objectStore("Libri").get(e);r.onsuccess=()=>{r.result?o(r.result):n(new Error("Libro non trovato"))},r.onerror=()=>n(r.error)}))}function c(c,i,a,s){return d=this,l=void 0,m=function*(){try{t=yield new Promise(((e,t)=>{const o=indexedDB.open("Database",1);o.onerror=()=>t(o.error),o.onsuccess=()=>e(o.result)}));const d=yield new Promise(((o,n)=>{const r=t.transaction("Venditori","readonly").objectStore("Venditori").get(Number(e));r.onsuccess=()=>{r.result?o(r.result.nome+" "+r.result.cognome):n(new Error("Venditore non trovato"))},r.onerror=()=>n(r.error)}));c.textContent=d,o=yield new Promise(((o,n)=>{const r=t.transaction("Copie","readonly").objectStore("Copie").getAll();r.onsuccess=()=>{const t=r.result.filter((t=>t.venditoreID===Number(e)));o(t)},r.onerror=()=>n(r.error)})),a.innerHTML="",n=0;for(const e of o){const t=yield r(String(e.libroDellaCopiaISBN)),o=document.createElement("tr"),c=document.createElement("td");c.textContent=t.titolo;const i=document.createElement("td");i.textContent=e.prezzoScontato.toFixed(2)+" €",o.appendChild(c),o.appendChild(i),a.appendChild(o),n+=e.prezzoScontato}s.textContent=n.toFixed(2),i.textContent=(new Date).toLocaleString()}catch(e){console.error("Errore nel caricamento:",e)}},new((u=void 0)||(u=Promise))((function(e,t){function o(e){try{r(m.next(e))}catch(e){t(e)}}function n(e){try{r(m.throw(e))}catch(e){t(e)}}function r(t){var r;t.done?e(t.value):(r=t.value,r instanceof u?r:new u((function(e){e(r)}))).then(o,n)}r((m=m.apply(d,l||[])).next())}));var d,l,u,m}document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("nomeVenditore"),t=document.getElementById("dataDeposito"),o=document.getElementById("corpoTabellaCopie"),n=document.getElementById("importoTotale"),r=document.getElementById("stampa");e&&t&&o&&n&&r?(r.addEventListener("click",(()=>{console.log("Stampa avviata"),window.print()})),c(e,t,o,n)):console.error("Uno o più elementi DOM non trovati.")}))})();